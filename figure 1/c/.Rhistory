plot(peaks.48hr.diff$V2/peaks.48hr.diff$V3, peaks.0hr.obs);abline(a=0,b=1)
plot(peaks.48hr.diff$V2/peaks.48hr.diff$V3, peaks.0hr.diff$V2/peaks.0hr.diff$V3);abline(a=0,b=1)
plot(peaks.48hr.diff$V3, peaks.0hr.diff$V3);abline(a=0,b=1)
plot(peaks.48hr.diff$V2/peaks.48hr.diff$V3, peaks.0hr.diff$V2/peaks.0hr.diff$V3);abline(a=0,b=1)
plot(peaks.48hr.diff$V2/peaks.48hr.diff$V3, peaks.0hr.diff$V2/peaks.0hr.diff$V3);abline(a=0,b=1);text(peaks.48hr.diff$V2/peaks.48hr.diff$V3,peaks.0hr.diff$V2/peaks.0hr.diff$V3,peaks.0hr.diff$V1)
setwd("~/Box Sync/Projects/cd4/figure 1/d")
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.0hr.diff
peaks.0hr.diff[1,]
dim(peaks.0hr.diff)
peaks.0hr.diff
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.ahred
peaks.shared
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28)];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,5,with=F], log.enrichment=peaks.48hr.diff[,8,with=F], neg.log.p=-peaks.48hr.diff[,9,with=F])
names
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28)];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,5,with=F], log.enrichment=peaks.48hr.diff[,8,with=F], neg.log.p=-peaks.48hr.diff[,9,with=F])
peaks.48hr.dr
peaks.48hr.df
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,5,with=F], log.enrichment=peaks.48hr.diff[,8,with=F], neg.log.p=-peaks.48hr.diff[,9,with=F])
peaks.48hr.df
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,5,with=F], log.enrichment=peaks.48hr.diff[,8,with=F], neg.log.p=-peaks.48hr.diff[,9,with=F])
peaks.48hr.df
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff$[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=-peaks.48hr.diff[,10,with=F])
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=-peaks.48hr.diff[,10,with=F])
peaks.48hr.df
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]))
peaks.48hr.dr
peaks.48hr.df
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
names <- c("Th.stim","Th17","Th0","T.naive","other","Treg","CD34","Promoter","Th1","Th2","5'","Other.T","Intergenic","B.cell","Tmem","Non-coding","Exon","3'","TTS","Intron");
peaks.48hr.diff <- peaks.48hr.diff[c(2:13,15,22:28),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]))
colnames(peaks.48hr.df) <- c("names","overlaps","log.enrichment","neg.log.p");
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,size=neg.log.p),data=peaks.48hr.df)+geom_point()+theme_bw();
ggsave(ggplot.48hr, "48hr.pdf")
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,size=neg.log.p),data=peaks.48hr.df)+geom_point()+theme_bw();
ggsave(ggplot.48hr, file="48hr.pdf")
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,size=neg.log.p),data=peaks.48hr.df)+geom_point()+theme_bw();
ggsave(ggplot.48hr, file="48hr.pdf")
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
ggsave(ggplot.48hr, file="48hr.pdf",width=7in,height=7in)
ggsave(ggplot.48hr, file="48hr.pdf",width="7in",height="7in")
help(ggsave)
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,size=neg.log.p),data=peaks.48hr.df)+geom_point()+theme_bw()+geom_text(aes(overlaps,log.enrichment),labels=names);
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
help(geom_text)
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,size=neg.log.p, label=names),data=peaks.48hr.df)+geom_point()+theme_bw()+geom_text();
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
ggplot.48hr
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,label=names),data=peaks.48hr.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
peaks.48hr.df
peaks.48hr.diff
peaks.48hr.diff[,c(1,5)]
peaks.48hr.diff[,c(1,6)]
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.48hr.diff[,1,with=F]
peaks.0hr.diff
peaks.0hr.diff[,1]
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
peaks.shared[,1]
peaks.48hr[,1]
peaks.48hr.diff[,1]
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.48hr.df <- data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]))
colnames(peaks.48hr.df) <- c("names","overlaps","log.enrichment","neg.log.p");
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,label=names),data=peaks.48hr.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
peaks.48hr.diff
peaks.48hr.diff[,peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");]
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.48hr.diff[,c(1,6)]
peaks.48hr.diff[,c(1,6:10)]
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,label=names),data=peaks.48hr.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text()+scale_size_continuous(range = c(0,500));
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,label=names),data=peaks.48hr.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
peaks.48hr.diff[,c(1,6:10)]
ggplot.48hr <- ggplot(aes(overlaps, log.enrichment,label=names),data=peaks.48hr.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text()+scale_size_continuous(limit = c(0,500));
ggsave(ggplot.48hr, file="48hr.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr")
data.frame(name=names, overlaps=peaks.shared[,6,with=F], log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared")
colnames(peaks.df) <- c("names","overlaps","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(overlaps, log.enrichment,label=names,color=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared")
colnames(peaks.df) <- c("names","overlaps","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(overlaps, log.enrichment,label=names,color=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(overlaps, log.enrichment,label=names,color=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
ggplot <- ggplot(aes(overlaps, log.enrichment,label=names,color=names,pch=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
ggplot <- ggplot(aes(overlaps, log.enrichment,color=names,pch=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw();
ggsave(ggplot, file="all.pdf",width=7,height=7)
peakspeaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.shared[1,]
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];peaks.shared[1,]peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.48hr.diff[1,]
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,color=names,pch=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,color=names,pch=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,color=names,groups=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,color=names,group=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,label=names,group.by=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,label=names,group=condition),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text();
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text()+facet_grid(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
df
peaks.df[1,]
peaks.df.48h <- peaks.df[which(peaks.df$condition=="48hr"),]
peaks.df.0h <- peaks.df[which(peaks.df$condition=="0hr"),]
peaks.df.48h
peaks.df.0h
plot(peaks.df.0hr$proportion,peaks.df.48hr$proportion);text(peaks.df.0hr$proportion,peaks.df.48hr$proportio,peaks.df.0hr$names)
plot(peaks.df.0h$proportion,peaks.df.48h$proportion);text(peaks.df.0h$proportion,peaks.df.48h$proportio,peaks.df.0hr$names)
plot(peaks.df.0h$proportion,peaks.df.48h$proportion);text(peaks.df.0h$proportion,peaks.df.48h$proportio,peaks.df.hr$names)
plot(peaks.df.0h$proportion,peaks.df.48h$proportion);text(peaks.df.0h$proportion,peaks.df.48h$proportio,peaks.df.0h$names)
plot(peaks.df.0h$proportion,peaks.df.48h$proportion);text(peaks.df.0h$proportion,peaks.df.48h$proportio,peaks.df.0h$names);abline(a=0,b=1)
peaks.df.48hr
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
peaks.df.0h
peaks.df.48h
plot(peaks.df.0hr$log.enrichment,peaks.df.48hr$log.enrichment);text(peaks.df.0hr$log.enrichment,peaks.df.48hr$log.enrichment,peaks.df.0hr$names)
plot(peaks.df.0h$log.enrichment,peaks.df.48h$log.enrichment);text(peaks.df.0h$log.enrichment,peaks.df.48h$log.enrichment,peaks.df.0h$names)
plot(peaks.df.0h$log.enrichment,peaks.df.48h$log.enrichment);text(peaks.df.0h$log.enrichment,peaks.df.48h$log.enrichment,peaks.df.0h$names);abline(a=0,b=1)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, log.enrichment,label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text()+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
peaks.df.0h
peaks.df.48h
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.shared$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
peaks.df.shared <- peaks.df[which(peaks.df$condition=="shared"),]
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.shared$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.shared$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.shared$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
plot(exp(peaks.df.48h$log.enrichment),exp(peaks.df.shared$log.enrichment));text(exp(peaks.df.48h$log.enrichment),exp(peaks.df.shared$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
plot(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment));text(exp(peaks.df.0h$log.enrichment),exp(peaks.df.48h$log.enrichment),peaks.df.0h$names);abline(a=0,b=1)
peaks.df.0h$
0
peaks.df.0h
peaks.df.48h
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text()+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_label()+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text(position=position_dodge())+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text(position=position_dodge(width=0.9))+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text(position="dodge")+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text(nudge_y=.5)+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
library(data.table);
library(ggplot2);
peaks.shared <- fread("shared.custom.genomeOntology.txt");
peaks.48hr.diff <- fread("48hr.custom.genomeOntology.txt");
peaks.0hr.diff <- fread("0hr.custom.genomeOntology.txt");
peaks.shared <- peaks.shared[order(peaks.shared[,1,with=F]),];
peaks.48hr.diff <- peaks.48hr.diff[order(peaks.48hr.diff[,1,with=F]),];
peaks.0hr.diff <- peaks.0hr.diff[order(peaks.0hr.diff[,1,with=F]),];
names <- c("3'","5'","B.cell","CD34","Intergenic","Other.T","T.naive","TTS","Th.stim","Th0","Th1","Th17","Th2","Tmem","Treg","Exon","Intron","Non-coding","Other","Promoter");
peaks.48hr.diff <- peaks.48hr.diff[c(1:15,20:24),];
peaks.0hr.diff <- peaks.0hr.diff[c(1:15,20:24),];
peaks.shared <- peaks.shared[c(1:15,20:24),];
peaks.df <- rbind(data.frame(name=names, overlaps=peaks.48hr.diff[,6,with=F], proportion=peaks.48hr.diff[,6,with=F]/28017, log.enrichment=peaks.48hr.diff[,9,with=F], neg.log.p=abs(peaks.48hr.diff[,10,with=F]), condition="48hr"),
data.frame(name=names, overlaps=peaks.0hr.diff[,6,with=F], proportion=peaks.0hr.diff[,6,with=F]/8298,log.enrichment=peaks.0hr.diff[,9,with=F], neg.log.p=abs(peaks.0hr.diff[,10,with=F]), condition="0hr"),
data.frame(name=names, overlaps=peaks.shared[,6,with=F], proportion=peaks.shared[,6,with=F]/27445,log.enrichment=peaks.shared[,9,with=F], neg.log.p=abs(peaks.shared[,10,with=F]), condition="shared"))
colnames(peaks.df) <- c("names","overlaps","proportion","log.enrichment","neg.log.p","condition");
ggplot <- ggplot(aes(proportion, exp(log.enrichment),label=names),data=peaks.df)+geom_point(aes(size=neg.log.p))+theme_bw()+geom_text(nudge_y=.25)+facet_wrap(~condition);
ggsave(ggplot, file="all.pdf",width=7,height=7)
